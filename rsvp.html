<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RSVP & Merchandise</title>

<style>
body { 
    margin: 0; 
    font-family: "Segoe UI", Arial, sans-serif; 
    background: #fff7ee; 
}
nav {
    background: #d9715f;
    padding: 15px 20px;
    display: flex;
    justify-content: center;
    gap: 30px;
    position: sticky;
    top: 0;
    z-index: 1000;
}
nav a {
    color: white;
    font-size: 1.1rem;
    text-decoration: none;
    font-weight: bold;
}
nav a:hover { text-decoration: underline; }
.section {
    max-width: 900px;
    margin: auto;
    padding: 20px;
}
.box {
    background: #ffffff;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    margin-bottom: 30px;
}
input, textarea, select {
    width: 100%;
    padding: 12px;
    margin: 10px 0;
    border-radius: 10px;
    border: 1px solid #bbb;
    font-size: 1rem;
}
label { font-weight: 600; display: block; margin-top: 10px; }
button {
    background: #d9715f;
    color: white;
    padding: 12px 20px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 1.1rem;
    margin-top: 10px;
}
button:hover { background: #c45f52; }
.total-display {
    font-weight: bold;
    color: #d9715f;
    margin-top: 10px;
    font-size: 1.2rem;
}
</style>
</head>

<body>

<nav>
    <a href="index.html">Home</a>
    <a href="gallery.html">Photo Gallery</a>
    <a href="payment.html">Payment</a>
    <a href="merchandise.html">Merchandise</a>
</nav>

<section class="section">
<div class="box">
    <h2 style="color:#d9715f; text-align:center;">RSVP & Merchandise</h2>

    <form id="rsvpForm" action="https://formspree.io/f/mvzpavbr" method="POST">

        <!-- Main Attendee -->
        <label>First Name:</label>
        <input type="text" name="first_name" required>

        <label>Last Name:</label>
        <input type="text" name="last_name" required>

        <label>Batch / Year:</label>
        <select name="batch" required>
            <option selected disabled>Select...</option>
            <option>1970s</option><option>1980</option><option>1981</option>
            <option>1982</option><option>1983</option><option>1984</option>
            <option>1985</option><option>1986</option><option>1987</option>
            <option>1988</option><option>1989</option><option>1990s</option>
            <option>2000s</option><option>Other</option>
        </select>

        <label>Email:</label>
        <input type="email" name="_replyto" required>

        <label>Will you attend?</label>
        <select name="attendance" id="attendance" required>
            <option value="" selected disabled>Select...</option>
            <option value="Yes">Yes, I will attend</option>
            <option value="No">No, I can't make it</option>
        </select>

        <label>Your T-Shirt Size:</label>
        <select name="shirt_size" id="main_shirt_size" required>
            <option value="" selected disabled>Select size...</option>
            <option>S</option><option>M</option><option>L</option>
            <option>XL</option><option>2XL</option><option>3XL</option>
        </select>

        <label>Number of Guests:</label>
        <input type="number" id="guestCount" name="guests" min="0" value="0">

        <!-- Dynamic Guest Fields -->
        <div id="guestNames"></div>

        <label>Message (optional):</label>
        <textarea name="message" rows="4"></textarea>

        <hr>

        <!-- Merchandise Fields -->
        <h3 style="color:#d9715f;">Merchandise</h3>

        <label>T-Shirt ($25 each):</label>
        <select name="tshirt_size_merch" id="tshirt_size_merch">
            <option value="" selected disabled>Select size...</option>
            <option>S - $25</option><option>M - $25</option>
            <option>L - $25</option><option>XL - $25</option>
            <option>2XL - $25</option><option>3XL - $25</option>
        </select>
        <input type="number" name="tshirt_qty" id="tshirt_qty" min="0" value="0">

        <label>Bull Cap ($15 each):</label>
        <select name="cap_size" id="cap_size">
            <option value="" selected disabled>Select size...</option>
            <option>One Size Fits All - $15</option>
        </select>
        <input type="number" name="cap_qty" id="cap_qty" min="0" value="0">

        <label>Hoodie ($40 each):</label>
        <select name="hoodie_size" id="hoodie_size">
            <option value="" selected disabled>Select size...</option>
            <option>S - $40</option><option>M - $40</option>
            <option>L - $40</option><option>XL - $40</option>
            <option>2XL - $40</option><option>3XL - $40</option>
        </select>
        <input type="number" name="hoodie_qty" id="hoodie_qty" min="0" value="0">

        <!-- Hidden Inputs for Form Submission -->
        <input type="hidden" name="_next" value="thankyou.html">
        <input type="hidden" name="rsvp_total_display" id="rsvp_total_display">
        <input type="hidden" name="merch_total_display" id="merch_total_display">
        <input type="hidden" name="grand_total_display" id="grand_total_display">

        <div class="total-display">
            RSVP Total: <span id="rsvp_total_text">$0</span><br>
            Merchandise Total: <span id="merch_total_text">$0</span><br>
            Grand Total: <span id="grand_total_text">$0</span>
        </div>

        <button type="submit">Submit RSVP & Merchandise</button>
    </form>
</div>
</section>

<script>
// Dynamic Guest Fields
const guestCount = document.getElementById("guestCount");
const guestNames = document.getElementById("guestNames");

function createGuestFields(count) {
    guestNames.innerHTML = "";
    if (count <= 0) return;

    for (let i = 1; i <= count; i++) {
        const container = document.createElement("div");
        container.style.border = "1px solid #eee";
        container.style.padding = "10px";
        container.style.marginTop = "10px";
        container.style.borderRadius = "8px";

        const title = document.createElement("label");
        title.textContent = `Guest ${i}: First Name, Last Name & T-Shirt Size`;
        container.appendChild(title);

        const firstInput = document.createElement("input");
        firstInput.type = "text";
        firstInput.name = `guest_${i}_first_name`;
        firstInput.placeholder = `Guest ${i} First Name`;
        firstInput.required = true;
        container.appendChild(firstInput);

        const lastInput = document.createElement("input");
        lastInput.type = "text";
        lastInput.name = `guest_${i}_last_name`;
        lastInput.placeholder = `Guest ${i} Last Name`;
        lastInput.required = true;
        container.appendChild(lastInput);

        const sizeSelect = document.createElement("select");
        sizeSelect.name = `guest_${i}_shirt_size`;
        sizeSelect.required = true;

        const defaultOption = document.createElement("option");
        defaultOption.textContent = "Select size...";
        defaultOption.disabled = true;
        defaultOption.selected = true;
        sizeSelect.appendChild(defaultOption);

        ["S","M","L","XL","2XL","3XL"].forEach(size => {
            const option = document.createElement("option");
            option.value = size;
            option.textContent = size;
            sizeSelect.appendChild(option);
        });

        container.appendChild(sizeSelect);
        guestNames.appendChild(container);
    }
}

guestCount.addEventListener("input", () => {
    const count = parseInt(guestCount.value) || 0;
    createGuestFields(count);
    updateTotals();
});

// Totals Calculation
const attendance = document.getElementById("attendance");
const tshirt_qty = document.getElementById("tshirt_qty");
const hoodie_qty = document.getElementById("hoodie_qty");
const cap_qty = document.getElementById("cap_qty");

function updateTotals() {
    const mainAttend = attendance.value === "Yes" ? 1 : 0;
    const guests = parseInt(guestCount.value) || 0;

    const rsvpTotal = (mainAttend + guests) * 150;
    const merchTotal = (parseInt(tshirt_qty.value)||0)*25 + 
                        (parseInt(hoodie_qty.value)||0)*40 + 
                        (parseInt(cap_qty.value)||0)*15;
    const grandTotal = rsvpTotal + merchTotal;

    document.getElementById("rsvp_total_text").textContent = `$${rsvpTotal}`;
    document.getElementById("merch_total_text").textContent = `$${merchTotal}`;
    document.getElementById("grand_total_text").textContent = `$${grandTotal}`;
}

// Update totals on any input change
[attendance, guestCount, tshirt_qty, hoodie_qty, cap_qty].forEach(el => {
    el.addEventListener("input", updateTotals);
});

// Update hidden inputs with $ sign before submitting
const form = document.getElementById("rsvpForm");
form.addEventListener("submit", function(e){
    const rsvpTotal = document.getElementById("rsvp_total_text").textContent;
    const merchTotal = document.getElementById("merch_total_text").textContent;
    const grandTotal = document.getElementById("grand_total_text").textContent;

    document.getElementById("rsvp_total_display").value = rsvpTotal;
    document.getElementById("merch_total_display").value = merchTotal;
    document.getElementById("grand_total_display").value = grandTotal;
});
</script>

</body>
</html>
